{% extends "base.html.twig" %}

{% block title %}Editar Exigibilidade{% endblock %}

{% block content %}
    <div class="container my-4">
        <h1>Editar Exigibilidade</h1>

        <form action="{{ path('web_exigibilidade_edit', {id: exigibilidade.id}) }}" method="post" id="exigibilidade-form">
            <div class="row">
                <div class="col-md-2 mb-3">
                    <label for="exercicio" class="form-label">Exercício</label>
                    <input type="text" maxlength="4" class="form-control" id="exercicio" name="exercicio" required value="{{ exigibilidade.exercicio }}">
                </div>
                <div class="col-md-2 mb-3">
                    <label for="semestre" class="form-label">Semestre</label>
                    <select class="form-control" id="semestre" name="semestre" required>
                        <option value="01" {{ exigibilidade.semestre == '01' ? 'selected' : '' }}>01</option>
                        <option value="02" {{ exigibilidade.semestre == '02' ? 'selected' : '' }}>02</option>
                    </select>
                </div>
                <div class="col-md-2 mb-3">
                    <label for="codFonteRecurso" class="form-label">Cód. Fonte do Recurso</label>
                    <input type="text" class="form-control" id="codFonteRecurso" name="codFonteRecurso" maxlength="2" value="{{ exigibilidade.codFonteRecurso }}">
                </div>
                <div class="col-md-3 mb-3">
                    <label for="tipoRecurso" class="form-label">Tipo do Recurso</label>
                    <select class="form-control" name="tipoRecurso" id="tipoRecurso">
                        <option value="" disabled>Selecione</option>
                        <option value="00" {% if exigibilidade.tipoRecurso == '00' %}selected{% endif %}>00 - Recurso vinculado</option>
                        <option value="01" {% if exigibilidade.tipoRecurso == '01' %}selected{% endif %}>01 - Não vinculado do tipo investimento</option>
                        <option value="02" {% if exigibilidade.tipoRecurso == '02' %}selected{% endif %}>02 - Não vinculado do tipo custeio</option>
                    </select>
                </div>
                <div class="col-md-3 mb-3">
                    <label for="tipoExigibilidade" class="form-label">Tipo de Exigibilidade</label>
                    <select class="form-control" name="tipoExigibilidade" id="tipoExigibilidade">
                        <option value="" disabled>Selecione</option>
                        <option value="01" {% if exigibilidade.tipoExigibilidade == '01' %}selected{% endif %}>01 - Bens</option>
                        <option value="02" {% if exigibilidade.tipoExigibilidade == '02' %}selected{% endif %}>02 - Locações</option>
                        <option value="03" {% if exigibilidade.tipoExigibilidade == '03' %}selected{% endif %}>03 - Realizações de obras</option>
                        <option value="04" {% if exigibilidade.tipoExigibilidade == '04' %}selected{% endif %}>04 - Prestação de serviços</option>
                    </select>
                </div>
            </div>
            <hr>
            <h5>Contrato de Empréstimo</h5>
            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="numContratoEmprestimo" class="form-label">Nº Contrato de Empréstimo</label>
                    <input type="text" class="form-control" id="numContratoEmprestimo" name="numContratoEmprestimo" maxlength="30" value="{{ exigibilidade.numContratoEmprestimo }}">
                </div>
                <div class="col-md-6 mb-3">
                    <label for="anoContratoEmprestimo" class="form-label">Ano do Contrato de Empréstimo</label>
                    <input type="text" class="form-control" id="anoContratoEmprestimo" name="anoContratoEmprestimo" maxlength="4" value="{{ exigibilidade.anoContratoEmprestimo }}">
                </div>
            </div>
            <hr>
            <h5>Convênio</h5>
            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="numConvenio" class="form-label">Nº do Convênio</label>
                    <input type="text" class="form-control" id="numConvenio" name="numConvenio" maxlength="30" value="{{ exigibilidade.numConvenio }}">
                </div>
                <div class="col-md-6 mb-3">
                    <label for="anoConvenio" class="form-label">Ano do Convênio</label>
                    <input type="text" class="form-control" id="anoConvenio" name="anoConvenio" maxlength="4" value="{{ exigibilidade.anoConvenio }}">
                </div>
            </div>
            <hr>
            <h5>Nota Fiscal</h5>
            <div class="row">
                <div class="col-md-4 mb-3">
                    <label for="numNotaFiscal" class="form-label">Nº da Nota Fiscal</label>
                    <input type="text" class="form-control" id="numNotaFiscal" name="numNotaFiscal" maxlength="30" value="{{ exigibilidade.numNotaFiscal }}">
                </div>
                <div class="col-md-4 mb-3">
                    <label for="dataNotaFiscal" class="form-label">Data da Nota Fiscal</label>
                    <input type="date" class="form-control" id="dataNotaFiscal" name="dataNotaFiscal" min="2024-01-01" max="{{ "now"|date("Y-m-d") }}" value="{{ exigibilidade.dataNotaFiscal }}">
                </div>
                <div class="col-md-4 mb-3">
                    <label for="dataAtesto" class="form-label">Data do Atesto</label>
                    <input type="date" class="form-control" id="dataAtesto" name="dataAtesto" min="2024-01-01" max="{{ "now"|date("Y-m-d") }}" value="{{ exigibilidade.dataAtesto }}">
                </div>
            </div>
            <hr>
            <h5>Pagamento</h5>
            <div class="row">
                <div class="col-md-4 mb-3">
                    <label for="idPagamento" class="form-label">ID do Pagamento</label>
                    <input type="text" class="form-control" id="idPagamento" name="idPagamento" maxlength="20" value="{{ exigibilidade.idPagamento }}" disabled>
                </div>
                <div class="col-md-4 mb-3">
                    <label for="dataPagamento" class="form-label">Data do Pagamento</label>
                    <input type="date" class="form-control" maxlength="10" id="dataPagamento" name="dataPagamento"  min="2024-01-01" max="{{ "now"|date("Y-m-d") }}" value="{{ exigibilidade.dataPagamento }}">
                </div>
                <div class="col-md-4 mb-3">
                    <label for="valorPagamento" class="form-label">Valor do Pagamento</label>
                    <input type="text" class="form-control" id="valorPagamento" name="valorPagamento" value="{{ exigibilidade.valorPagamento|number_format(2, ',', '.') }}">
                </div>
            </div>
            <hr>
            <h5>Contrato</h5>
            <div class="row">
                 <div class="col-md-3 mb-3">
                    <label for="numContrato" class="form-label">Nº do Contrato</label>
                    <input type="text" class="form-control" id="numContrato" name="numContrato" maxlength="30" value="{{ exigibilidade.numContrato }}">
                </div>
                 <div class="col-md-3 mb-3">
                    <label for="anoContrato" class="form-label">Ano do Contrato</label>
                    <input type="text" class="form-control" id="anoContrato" name="anoContrato" maxlength="4" value="{{ exigibilidade.anoContrato }}">
                </div>
                <div class="col-md-3 mb-3">
                    <label for="valorContratacao" class="form-label">Valor da Contratação</label>
                    <input type="text" class="form-control" id="valorContratacao" name="valorContratacao" value="{{ exigibilidade.valorContratacao|number_format(2, ',', '.') }}">
                </div>
                <div class="col-md-3 mb-3">
                    <label for="cpfCnpjCredor" class="form-label">CPF/CNPJ do Credor</label>
                    <input type="text" class="form-control" id="cpfCnpjCredor" name="cpfCnpjCredor" maxlength="18" value="{{ exigibilidade.cpfCnpjCredor }}">
                </div>
            </div>
            <div class="row">
                <div class="col-12 mb-3">
                    <label class="form-label">Justificativa (Opcional)</label>

                    {% set predefined_justificativas = ["Pagamento conforme contrato", "Pendencia documentação", "Pagamento conforme cláusula contratual"] %}
                    {% set is_other = exigibilidade.justificativa and exigibilidade.justificativa not in predefined_justificativas %}
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="justificativa_opt" value="" id="vazio" checked>
                        <label class="form-check-label" for="vazio">
                            Sem justificativa
                        </label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="justificativa_opt" value="Pagamento conforme contrato" id="just1" {{ exigibilidade.justificativa == "Pagamento conforme contrato" ? 'checked' : '' }}>
                        <label class="form-check-label" for="just1">
                            Pagamento conforme contrato
                        </label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="justificativa_opt" value="Pendencia documentação" id="just2" {{ exigibilidade.justificativa == "Pendencia documentação" ? 'checked' : '' }}>
                        <label class="form-check-label" for="just2">
                            Pendencia documentação
                        </label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="justificativa_opt" value="Pagamento conforme cláusula contratual" id="just3" {{ exigibilidade.justificativa == "Pagamento conforme cláusula contratual" ? 'checked' : '' }}>
                        <label class="form-check-label" for="just3">
                            Pagamento conforme cláusula contratual
                        </label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="justificativa_opt" value="outro" id="just_outro" {{ is_other ? 'checked' : '' }}>
                        <label class="form-check-label" for="just_outro">
                            Outro
                        </label>
                    </div>
                    <textarea class="form-control mt-2" id="justificativa_texto" rows="3" style="{{ not is_other ? 'display:none;' : '' }}" maxlength="254">{{ is_other ? exigibilidade.justificativa : '' }}</textarea>
                    <input type="hidden" name="justificativa" id="justificativa">
                </div>
            </div>
            <button type="submit" class="btn btn-primary">Salvar Alterações</button>
            <a href="{{ path('web_exigibilidade_list') }}" class="btn btn-secondary">Cancelar</a>
        </form>
    </div>
{% endblock %}
{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('js/justificativa.js') }}"></script>
{% endblock %}
